PORTB <- SW MA TRAN

START:  	RCALL KEY_RD; DOC PHIM
		CP R24,R17
		BREQ START
		OUT PORTA,R17;HIEN THI BARLED
		MOV R24,R17
;PHAN HIEN THI LCD
RJMP START

KEY_RD:
		LDI R16,50
BACK1:
		RCALL GET_KEY16
		BRCC NONE
		DEC R16
		BRNE BACK1
		;LUU MA SW DUOC NHAN 
		;R17 -> ma phim
		RET
NONE:
		SER R17
		RJMP NONE1
GET_KEY16:
		LDI R17,4
		LDI R20,$FE
SCAN_COL:
		OUT PORTB,R20
		IN R19,PINB
		IN R19,PINB
		ANDI R19,$F0
		CPI R19,$F0
		BRNE CHK_KEY
		LSL R20
		INC R20
		DEC R17
		BRNE SCAN_COL
		CLC
		RJMP EXIT
CHK_KEY:SUBI R17,4
		NEG R17
		SWAP R19
		LDI R20,4
SCAN_ROW:
		ROR R19
		BRCC SET_FLG
		INC R17
		INC R17
		INC R17
		INC R17
		DEC R20
		BRNE SCAN_ROW
		CLC
		RJMP EXIT
SET_FLG:	SEC
		EXIT: RET